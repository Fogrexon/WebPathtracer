<!doctype html>
<html lang=en-us>
<head>
  <meta charset=utf-8>
  <meta content="text/html; charset=utf-8" http-equiv=Content-Type>
  <title>Hello WASM World!</title>
</head>
<body>
  <canvas id="cnv" width=500 height=500></canvas>
  <script src="../build/umd/pathtracer.js"></script>
  <script>
    const wasmManager = new PathTracer.WasmManager('../build/wasm/main.wasm');
    wasmManager.addEventListener('initialized', () => {
      const gltfModel = new PathTracer.GLTFLoader();
      
      gltfModel.load('spheres_smooth_floor.gltf').then(() => {
        const renderer = new PathTracer.Renderer(wasmManager, gltfModel);
        renderer.createBound();

        const cam = new PathTracer.Camera(Math.PI * 0.5);

        let rotate = 0;
        setInterval(() => {
          rotate += Math.PI * 0.1;

          cam.pos = new PathTracer.Vector3(4.0 * Math.cos(rotate), 0.5, 4.0 * Math.sin(rotate));
          cam.lookAt(new PathTracer.Vector3(0.0, 0.0, 0.0))

          renderer.render(document.getElementById('cnv'), cam);
        }, 100);
  
  
        // renderer.release();
      });
    });
  </script>
</body>
</html>